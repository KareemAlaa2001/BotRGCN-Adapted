importing the dataset...
Loading train.json
Loading test.json
Small dataset version, not loading support.json
Loading dev.json
Finished
Loading labels...   Finished
Loading user description embeddings
Finished
Running tweet embedding
Finished
Processing feature3...   Finished
Processing feature4...   Finished
Building graph   Finished
beginning training...






  5%|████▉                                                                                             | 5/100 [02:23<45:16, 28.59s/it]





 10%|█████████▋                                                                                       | 10/100 [04:33<39:00, 26.01s/it]





 15%|██████████████▌                                                                                  | 15/100 [06:28<33:12, 23.44s/it]





 20%|███████████████████▍                                                                             | 20/100 [08:19<29:45, 22.32s/it]





 25%|████████████████████████▎                                                                        | 25/100 [10:11<27:55, 22.35s/it]





 30%|█████████████████████████████                                                                    | 30/100 [12:02<25:50, 22.16s/it]




 34%|████████████████████████████████▉                                                                | 34/100 [13:31<24:23, 22.18s/it]






 40%|██████████████████████████████████████▊                                                          | 40/100 [15:45<22:20, 22.34s/it]





 45%|███████████████████████████████████████████▋                                                     | 45/100 [17:35<20:21, 22.21s/it]




 49%|███████████████████████████████████████████████▌                                                 | 49/100 [19:04<18:48, 22.13s/it]





 54%|████████████████████████████████████████████████████▍                                            | 54/100 [20:54<16:50, 21.98s/it]





 59%|█████████████████████████████████████████████████████████▏                                       | 59/100 [22:44<15:00, 21.96s/it]





 64%|██████████████████████████████████████████████████████████████                                   | 64/100 [24:46<14:11, 23.64s/it]





 69%|██████████████████████████████████████████████████████████████████▉                              | 69/100 [26:39<11:43, 22.68s/it]





 74%|███████████████████████████████████████████████████████████████████████▊                         | 74/100 [28:33<09:44, 22.49s/it]





 79%|████████████████████████████████████████████████████████████████████████████▋                    | 79/100 [30:35<08:36, 24.57s/it]





 84%|█████████████████████████████████████████████████████████████████████████████████▍               | 84/100 [32:44<06:52, 25.79s/it]





 89%|██████████████████████████████████████████████████████████████████████████████████████▎          | 89/100 [34:50<04:33, 24.90s/it]





 94%|███████████████████████████████████████████████████████████████████████████████████████████▏     | 94/100 [36:46<02:22, 23.69s/it]





 99%|████████████████████████████████████████████████████████████████████████████████████████████████ | 99/100 [38:51<00:24, 24.68s/it]

100%|████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [39:15<00:00, 23.55s/it]
Traceback (most recent call last):
  File "trainTestHetero.py", line 124, in <module>
    test()
  File "trainTestHetero.py", line 98, in test
    f1 = f1_score( labels_test,out_test)
  File "/usr/local/anaconda3/envs/mlp/lib/python3.7/site-packages/sklearn/metrics/_classification.py", line 1131, in f1_score
    zero_division=zero_division,
  File "/usr/local/anaconda3/envs/mlp/lib/python3.7/site-packages/sklearn/metrics/_classification.py", line 1270, in fbeta_score
    zero_division=zero_division,
  File "/usr/local/anaconda3/envs/mlp/lib/python3.7/site-packages/sklearn/metrics/_classification.py", line 1544, in precision_recall_fscore_support
    labels = _check_set_wise_labels(y_true, y_pred, average, labels, pos_label)
  File "/usr/local/anaconda3/envs/mlp/lib/python3.7/site-packages/sklearn/metrics/_classification.py", line 1348, in _check_set_wise_labels
    y_type, y_true, y_pred = _check_targets(y_true, y_pred)
  File "/usr/local/anaconda3/envs/mlp/lib/python3.7/site-packages/sklearn/metrics/_classification.py", line 86, in _check_targets
    type_pred = type_of_target(y_pred)
  File "/usr/local/anaconda3/envs/mlp/lib/python3.7/site-packages/sklearn/utils/multiclass.py", line 278, in type_of_target
    if is_multilabel(y):
  File "/usr/local/anaconda3/envs/mlp/lib/python3.7/site-packages/sklearn/utils/multiclass.py", line 150, in is_multilabel
    y = np.asarray(y)
  File "/usr/local/anaconda3/envs/mlp/lib/python3.7/site-packages/torch/_tensor.py", line 678, in __array__
    return self.numpy()
RuntimeError: Can't call numpy() on Tensor that requires grad. Use tensor.detach().numpy() instead.